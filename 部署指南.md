# 学校机房文件传输系统 - 部署指南

## 部署架构

```
机房网络环境
├── 服务器计算机 (教师机)
│   ├── 文件服务器.exe
│   └── data/ 目录
├── 教师客户端
│   └── 老师端.exe
└── 学生客户端 (多台)
    └── 学生端.exe
```

## 部署步骤

### 1. 服务器部署

#### 1.1 选择服务器计算机

- 选择一台性能较好的计算机作为服务器
- 建议使用教师机或专门的服务器
- 确保该计算机网络稳定

#### 1.2 安装服务器程序

1. 将 `文件服务器.exe` 复制到服务器计算机
2. 创建 `data` 目录（程序会自动创建）
3. 确保有足够的磁盘空间存储文件

#### 1.3 配置网络

1. 记录服务器计算机的 IP 地址
2. 确保防火墙允许 5000 端口通信
3. 测试网络连通性

#### 1.4 启动服务器

```bash
# 方法1：直接运行
文件服务器.exe

# 方法2：使用批处理文件
启动服务器.bat
```

### 2. 教师端部署

#### 2.1 安装教师端程序

1. 将 `老师端.exe` 复制到教师计算机
2. 确保教师计算机能访问服务器

#### 2.2 配置连接

1. 启动教师端程序
2. 程序默认连接 `http://localhost:5000`
3. 如果服务器在其他计算机，需要修改连接地址

#### 2.3 测试功能

1. 尝试上传一个测试文件
2. 检查文件是否出现在服务器
3. 测试下载功能

### 3. 学生端部署

#### 3.1 批量部署

1. 将 `学生端.exe` 复制到所有学生计算机
2. 可以使用网络共享或 U 盘分发
3. 确保所有学生计算机能访问服务器

#### 3.2 配置网络

1. 修改学生端程序中的服务器地址
2. 将 `localhost` 改为服务器 IP 地址
3. 例如：`http://192.168.1.100:5000`

#### 3.3 学生培训

1. 教学生如何输入姓名
2. 演示下载和上传操作
3. 说明注意事项

## 网络配置

### 局域网部署

#### 服务器配置

```bash
# 服务器IP: 192.168.1.100
# 端口: 5000
# 访问地址: http://192.168.1.100:5000
```

#### 客户端配置

修改 `client/common.py` 中的服务器地址：

```python
def __init__(self, base_url: str = "http://192.168.1.100:5000"):
```

### 互联网部署

#### 服务器配置

1. 配置公网 IP 或域名
2. 设置端口转发（5000 端口）
3. 配置 SSL 证书（可选）

#### 客户端配置

```python
def __init__(self, base_url: str = "http://your-domain.com:5000"):
```

## 安全配置

### 1. 防火墙设置

```bash
# Windows防火墙规则
# 入站规则：允许端口5000
# 出站规则：允许端口5000
```

### 2. 文件权限

- 设置 `data` 目录权限
- 限制非管理员用户访问
- 定期备份重要文件

### 3. 网络安全

- 使用内网部署（推荐）
- 如需外网访问，配置 VPN
- 定期更新系统补丁

## 监控和维护

### 1. 服务器监控

- 监控服务器运行状态
- 检查磁盘空间使用情况
- 查看错误日志

### 2. 文件管理

- 定期清理过期文件
- 备份重要数据
- 监控文件大小

### 3. 性能优化

- 定期重启服务器
- 清理临时文件
- 优化网络配置

## 故障排除

### 常见问题

#### 1. 服务器无法启动

**症状**：双击 exe 文件无反应
**解决方案**：

- 检查系统兼容性
- 以管理员身份运行
- 查看错误日志

#### 2. 客户端连接失败

**症状**：客户端提示连接错误
**解决方案**：

- 检查服务器是否启动
- 验证网络连接
- 检查防火墙设置
- 确认服务器地址正确

#### 3. 文件上传失败

**症状**：上传文件时出错
**解决方案**：

- 检查文件大小（限制 100MB）
- 验证磁盘空间
- 检查文件权限
- 重启服务器

#### 4. 学生端无法设置姓名

**症状**：输入姓名后程序无响应
**解决方案**：

- 重新启动程序
- 检查输入格式
- 查看错误信息

### 日志分析

#### 服务器日志

服务器控制台会显示：

- 启动信息
- 请求日志
- 错误信息
- 文件操作记录

#### 客户端日志

客户端状态栏显示：

- 连接状态
- 操作进度
- 错误提示

## 备份和恢复

### 数据备份

1. 定期备份 `data` 目录
2. 备份 `metadata.json` 文件
3. 记录服务器配置信息

### 数据恢复

1. 停止服务器
2. 恢复 `data` 目录
3. 重启服务器
4. 验证数据完整性

## 升级指南

### 程序升级

1. 停止所有客户端
2. 停止服务器
3. 备份现有数据
4. 替换程序文件
5. 启动服务器
6. 启动客户端

### 数据迁移

1. 导出现有数据
2. 在新系统中导入
3. 验证数据完整性
4. 更新客户端配置

## 联系支持

如遇到部署问题，请提供：

1. 系统版本信息
2. 错误日志
3. 网络配置
4. 问题描述

技术支持邮箱：support@school.edu
